!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,r,a){Object.defineProperty(e,t,{get:r,set:a,enumerable:!0,configurable:!0})}var r=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequirecbf3,a=r.register;a("7Vqk1",(function(a,n){t(a.exports,"BuildStatusCard",(function(){return S}));var o=r("fPPqr"),s=r("9nHZC"),i=r("agjvf"),l=r("EKmRU"),u=r("3THTN"),d=r("jeexd"),c=r("a7iuM"),f=r("a7A34"),p=r("9ovwz"),g=r("aUuqL"),m=r("bb66M"),h=r("d9fDf"),b=r("fM6HV"),E=r("bqc1A");class C extends s.PureComponent{constructor(...t){super(...t),this.renderLabels=()=>{const{buildStatusResult:{builds:t},intl:r}=this.props,{FAILED:a,SUCCESSFUL:n}=(0,E.getBuildStatuses)(t);if(0===t.length){const t=0;return{rich:e(s).createElement(i.FormattedMessage,e(o)({},m.default.zeroBuilds,{values:{formattedCount:e(s).createElement("strong",null,t)}})),plain:r.formatMessage(m.default.zeroBuilds,{formattedCount:t})}}if(a){const n=`${a} of ${t.length}`;return{rich:e(s).createElement(i.FormattedMessage,e(o)({},m.default.failedStatus,{values:{total:t.length,formattedCount:e(s).createElement("strong",null,n)}})),plain:r.formatMessage(m.default.failedStatus,{total:t.length,formattedCount:n})}}const l=`${n} of ${t.length}`;return{rich:e(s).createElement(i.FormattedMessage,e(o)({},m.default.passedStatus,{values:{total:t.length,formattedCount:e(s).createElement("strong",null,l)}})),plain:r.formatMessage(m.default.passedStatus,{total:t.length,formattedCount:l})}},this.renderExpanderContent=()=>{const{builds:t,hasError:r,refetch:a,repositoryFullSlug:n,hasStatuses:o}=this.props.buildStatusResult;return r?e(s).createElement(p.default,{iconType:"warning",title:e(s).createElement(i.FormattedMessage,m.default.errorHeading)},e(s).createElement(l.default,{appearance:"link",onClick:a},e(s).createElement(i.FormattedMessage,m.default.errorAction))):t.length?e(s).createElement(f.BuildSummary,{builds:t}):n&&!o?e(s).createElement(h.default,{repositoryFullSlug:n}):null}}render(){const{isCollapsed:t,intl:r,buildStatusResult:{isLoading:a}}=this.props,{plain:n,rich:o}=this.renderLabels(),i=e(s).createElement(e(d),{label:""});return t?e(s).createElement(c.default,{position:"left",content:n},e(s).createElement(u.default,{appearance:"subtle",iconBefore:i})):e(s).createElement(g.ConnectedExpander,{localStorageKey:"build.card.collapsed",icon:i,dataTestId:"build-status-card",isLoading:a,label:o,sectionAriaLabel:r.formatMessage(m.default.sectionAriaLabel),headingAriaLabel:n},this.renderExpanderContent())}}C.defaultProps={isCollapsed:!1};const S=(0,i.injectIntl)((0,b.withBuildStatus)(C))})),a("aUuqL",(function(a,n){t(a.exports,"ConnectedExpander",(function(){return u}));var o=r("fPPqr"),s=r("9nHZC"),i=r("kqytH"),l=r("bik9K");const u=({localStorageKey:t,onChange:r,defaultIsCollapsed:a,...n})=>{const{isCardCollapsed:u,setIsCardCollapsed:d}=(0,l.useIsCardCollapsed)({localStorageKey:t,defaultIsCardCollapsed:a}),c=(0,s.useCallback)((e=>{void 0!==r&&r(e),d(e)}),[r,d]);return e(s).createElement(i.default,e(o)({isCollapsed:u,onChange:c},n))}})),a("bik9K",(function(e,a){t(e.exports,"useIsCardCollapsed",(function(){return l}));var n=r("9nHZC"),o=r("dGzLf"),s=r("e2kK7"),i=r("h3kk7");const l=({localStorageKey:e,defaultIsCardCollapsed:t=!1})=>{const r=i.default.get(e,void 0);let a=(0,o.useSelector)((t=>(0,s.getIsCardCollapsed)(t,e)));void 0===a&&(a=void 0===r?t:r);const l=(0,o.useDispatch)(),u=(0,n.useCallback)((t=>t.isCollapsed?l((0,s.collapseCard)(e)):l((0,s.expandCard)(e))),[l,e]);return(0,n.useEffect)((()=>{i.default.set(e,a)}),[e,a]),(0,n.useEffect)((()=>{u({isCollapsed:a})}),[]),{isCardCollapsed:a,setIsCardCollapsed:u}}})),a("bb66M",(function(e,a){t(e.exports,"default",(function(){return n}));var n=(0,r("agjvf").defineMessages)({sectionAriaLabel:{id:"repository.buildStatus.sectionAriaLabel",defaultMessage:"Build statuses"},failedStatus:{id:"repository.buildStatus.tooltipFailed",defaultMessage:"{total, plural, one {{formattedCount} build} other {{formattedCount} builds}} failed"},passedStatus:{id:"repository.buildStatus.tooltipSuccess",defaultMessage:"{total, plural, one {{formattedCount} build passed} other {{formattedCount} builds passed}}"},zeroBuilds:{id:"repository.buildStatus.zeroBuilds",defaultMessage:"{formattedCount} builds"},errorHeading:{id:"repository.buildStatus.error.heading",defaultMessage:"Couldn't load builds"},errorAction:{id:"repository.buildStatus.error.action",defaultMessage:"Try again"}})})),a("d9fDf",(function(a,n){t(a.exports,"default",(function(){return o}));var o,s=r("fPPqr"),i=r("9nHZC"),l=r("agjvf"),u=r("kZnTB"),d=r("4pNi0"),c=r("8v97y"),f=r("2n44e");o=class extends i.PureComponent{render(){const[t,r]=this.props.repositoryFullSlug.split("/");return e(i).createElement(i.Fragment,null,e(i).createElement(c.PipelinesPromotionIcon,{alt:"Code emerging from a folder, with a green tick implying it's correctly working.",height:"104",src:e(f)}),e(i).createElement(c.PipelinesPromotionRow,null,e(i).createElement(l.FormattedMessage,e(s)({},d.default.promotionLineOne,{values:{bitbucketPipelinesDocumentation:e(i).createElement("a",{target:"_blank",href:"https://confluence.atlassian.com/bitbucket/get-started-with-bitbucket-pipelines-792298921.html"},e(i).createElement(l.FormattedMessage,d.default.promotionPipelinesDocumentationLink))}}))),e(i).createElement(c.PipelinesPromotionRow,null,e(i).createElement(l.FormattedMessage,d.default.promotionLineTwo)),e(i).createElement(c.PipelinesPromotionLink,null,e(i).createElement("a",{href:u.default.ui.pipelines(t,r)},e(i).createElement(l.FormattedMessage,d.default.promotionSetUpBitbucketPipelinesLink))))}}})),a("4pNi0",(function(e,a){t(e.exports,"default",(function(){return n}));var n=(0,r("agjvf").defineMessages)({promotionLineOne:{id:"frontbucket.repository.source.promotionLineOne",defaultMessage:"It looks like you haven\u2019t configured a build tool yet. You can use {bitbucketPipelinesDocumentation} to build, test and deploy your code."},promotionLineTwo:{id:"frontbucket.repository.source.promotionLineTwo",defaultMessage:"Your existing plan already includes build minutes."},promotionSetUpBitbucketPipelinesLink:{id:"frontbucket.repository.source.promotionSetUpBitbucketPipelinesLink",defaultMessage:"Set up a pipeline"},promotionPipelinesDocumentationLink:{id:"frontbucket.repository.source.promotionPipelinesDocumentationLink",defaultMessage:"Bitbucket Pipelines"}})})),a("8v97y",(function(e,a){t(e.exports,"PipelinesPromotionIcon",(function(){return l})),t(e.exports,"PipelinesPromotionRow",(function(){return u})),t(e.exports,"PipelinesPromotionLink",(function(){return d}));var n=r("2xJU3"),o=r("jp7ng"),s=r("aP6k3"),i=r("h39Sh");const l=(0,n.default)("img",{target:"e1jexyus0"})({name:"68vl60",styles:"margin:12px auto 22px auto;display:block;height:100px;"}),u=(0,n.default)("p",{target:"e1jexyus1"})("margin-bottom:",s.gridSize,";text-align:left;padding:0 ",(0,s.gridSize)()/2,"px;"),d=(0,n.default)("p",{target:"e1jexyus2"})("margin-top:",2*(0,s.gridSize)(),"px;text-align:center;border-top:1px solid ",(0,i.default)("color.border",o.N40A),";padding:",(0,s.gridSize)(),"px;")})),a("2n44e",(function(e,t){e.exports=r("fUFji").getBundleURL("fYWVF")+"pipelines-promotion-icon.8b4bf826.png"})),a("fUFji",(function(e,r){var a,n;t(e.exports,"getBundleURL",(function(){return a}),(function(e){return a=e})),t(e.exports,"getOrigin",(function(){return n}),(function(e){return n=e}));var o={};function s(e){return(""+e).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/.+)\/[^/]+$/,"$1")+"/"}a=function(e){var t=o[e];return t||(t=function(){try{throw new Error}catch(t){var e=(""+t.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^)\n]+/g);if(e)return s(e[2])}return"/"}(),o[e]=t),t},n=function(e){var t=(""+e).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^/]+/);if(!t)throw new Error("Origin not found");return t[0]}})),a("fM6HV",(function(a,n){t(a.exports,"BuildStatusProvider",(function(){return c})),t(a.exports,"useBuildStatus",(function(){return f})),t(a.exports,"withBuildStatus",(function(){return p}));var o=r("fPPqr"),s=r("9nHZC"),i=r("dGzLf"),l=r("1EkdU"),u=r("Ek4uG");const d=(0,s.createContext)(null),c=({repositoryMetadataURL:t,buildStatusURL:r,repositoryFullSlug:a,children:n})=>{const{builds:o,hasStatuses:c,isLoading:f,hasError:p,refetch:g}=(({repositoryMetadataURL:e,buildStatusURL:t})=>{const{data:r,isLoading:a,hasError:n,refetch:o}=(0,u.useAuthRequest)({url:e}),{data:d,isLoading:c,hasError:f,fetchData:p,clearData:g}=(0,u.useAuthRequestLazy)({url:t}),m=(null==r?void 0:r.has_statuses)||!1,h=(null==d?void 0:d.values)||[],b=f||n,E=c||a,C=(0,i.useSelector)(l.getPullRequestRefetchBuildsDummy);(0,s.useEffect)((()=>{m?p():g()}),[p,g,m,C]);const S=(0,s.useCallback)((()=>{o(),g()}),[o,g]);return{builds:h,hasStatuses:m,isLoading:E,hasError:b,refetch:S}})({repositoryMetadataURL:t,buildStatusURL:r}),m=(0,s.useMemo)((()=>({builds:o,hasStatuses:c,isLoading:f,hasError:p,refetch:g,repositoryFullSlug:a})),[o,c,f,p,g,a]);return e(s).createElement(d.Provider,{value:m},n)},f=()=>{const e=(0,s.useContext)(d);if(null===e)throw new Error("useBuildStatus requires a parent BuildStatusProvider");return e},p=t=>r=>{const a=f();return e(s).createElement(t,e(o)({buildStatusResult:a},r))}})),a("Ek4uG",(function(e,a){t(e.exports,"useAuthRequestLazy",(function(){return s})),t(e.exports,"useAuthRequest",(function(){return i}));var n=r("9nHZC"),o=r("k2cPS");const s=({url:e})=>{const[{data:t,isLoading:r,hasError:a},s]=(0,n.useState)({data:null,isLoading:!0,hasError:!1}),i=(0,n.useCallback)((()=>{s({isLoading:!1,hasError:!1,data:null})}),[s]);return{data:t,isLoading:r,hasError:a,fetchData:(0,n.useCallback)((async()=>{if(!e)return;s({isLoading:!0,hasError:!1,data:null});const t=await fetch((0,o.default)(e));if(t.ok)try{s({isLoading:!1,hasError:!1,data:await t.json()})}catch(e){s({data:null,hasError:!0,isLoading:!1})}else s({data:null,isLoading:!1,hasError:!0})}),[e]),clearData:i}},i=({url:e})=>{const{data:t,isLoading:r,hasError:a,fetchData:o,clearData:i}=s({url:e});(0,n.useEffect)((()=>{o()}),[o]);return{data:t,isLoading:r,hasError:a,refetch:(0,n.useCallback)((()=>{i(),o()}),[i,o]),clearData:i}}})),a("bqc1A",(function(e,r){function a(e){return e.reduce(((e,t)=>(e[t.state]+=1,e)),{FAILED:0,INPROGRESS:0,STOPPED:0,SUCCESSFUL:0})}t(e.exports,"getBuildStatuses",(function(){return a}))}))}();
//# sourceMappingURL=source-diff.dc7e5786.js.map
